# 两个离散随机变量的分布

2023-05-25
****
## 1. 简介

如何将一个随机变量 $X$ 的概率分布概念扩展到两个随机变量 $X$ 和 $Y$ 的联合分布。假设 $X$ 和 $Y$ 是离散随机变量，我们可能需要知道 $X$ 和 $Y$ 是否相关，以及当 $X$ 取 $x$ 且 $Y$ 取 $y$ 时的概率，即 $P(X=x, Y=y)$。

主要内容：

- 两个离散随机变量的联合概率质量函数（PMF）的定义
- 使用联合 PMF 计算特定事件的概率
- 根据 $X$ 和 $Y$ 的联合 PMF 计算离散随机变量 $X$ 的边缘 PMF
- 随机变量 $X$ 和 $Y$ 相互独立的定义
- 根据联合 PMF 计算离散随机变量 $X$ 和 $Y$ 函数的期望值
- 使用离散随机变量 $X$ 和 $Y$ 的联合 PMF 计算均值和方差
- $X$ 和 $Y$ 具有联合三角支集的含义
- 如果两个随机变量 $X$ 和 $Y$ 有联合三角支集，则它们一定相关
- $X$ 和 $Y$ 具有联合矩形支集的含义
- 如果两个随机变量 $X$ 和 $Y$ 有联合矩形支集，则它们可能独立，也可能相关
- 三项分布（trinomial distribution）

## 2. 两个离散随机变量

假设有两个随机变量 $X$ 和 $Y$，它们都是离散的。

**例如**：投掷一对均匀的四面骰子，其中一个骰子红色，一个黑色。令：

- $X=$ 红色骰子的结果 $={1,2,3,4}$
- $Y=$ 黑色骰子的结果 $={1,2,3,4}$

那么，$X$ 取 $x$ 且 $Y$ 取 $y$ 的概率是多少，即求解 $P(X=x,Y=y)$ 的值？

**解：** 为了找到 $X$ 和 $Y$ 的联合概率分布，首先定义支集，$X$ 的支集 (support)：
$$S_1=\{1,2,3,4\}$$
$Y$ 的支集：
$$S_2=\{1,2,3,4\}$$
```ad-note
支集：所有可能取值的集合。
```

令 $(x,y)$ 为投掷一对骰子一次的结果，可能结果组成的联合支集 $S$ 有 16 种可能：

$$
\begin{aligned}
S=\{&(1,1),(1,2),(1,3),(1,4),(2,1),(2,2),(2,3),(2,4),\\
&(3,1),(3,2),(3,3),(3,4),(4,1),(4,2),(4,3),(4,4)\}
\end{aligned}
$$

因为骰子是均匀的，因此 16 种结果的概率是相同的。因此，$X$ 等于特定 $x$ 且 $Y$ 等于特定 $y$ 的概率为 $1/16$。即对支集 $S$ 中的所有 $(x,y)$：
$$P(X=x,Y=y)=\frac{1}{16}$$
确定每个 $(x,y)$ 的概率后，就可以确定所谓的联合概率质量函数（PMF）。联合 PMF 通常记作 $f(x,y)$，可以表示为公式（如上所示）、图形和表格。下面是联合 PMF 的表格形式：

![[Pasted image 20230524155632.png|350]]

下面给出联合概率质量函数的正式定义。

### 联合概率质量函数

假设 $X$ 和 $Y$ 是两个离散随机变量，$S$ 是两者的二维支集。如果 $f(x,y)=P(X=x,Y=y)$ 满足以下三个条件，则其为联合 PMF：

1. $0\le f(x,y)\le 1$，即概率在 0 到 1 之间
2. $\sum\sum_{(x,y)\in S}=1$，整个支集 $S$ 的概率和为 1
3. $P[(X,Y)\in A]={\sum\sum}_{(x,y)\in A}f(x,y)$，$A$ 是支集 $S$ 的子集，要确定事件 $A$ 的概率，只需要将 $A$ 包含的 $(x,y)$ 的概率相加

回头看表格形式的 PMF，可以发现最后一列是单独 $X$ 的 PMF，最后一行是单独 $Y$ 的 PMF。这两个函数 $f(x)$ 和 $f(y)$，在该情况通常被称为**边缘概率质量函数**（marginal probability mass function）。为了获得 $X$ 的 PMF，对每个 $x$，将对应 $y=1,2,3,4$ 的所有概率相加，即对每个 $x$ 计算 $f(x,1)$, $f(x,2)$, $f(x,3)$, $f(x,4)$ 的加和。下面给出边缘 PMF 的正式定义。

### $X$ 的边缘 PMF

设 $X$ 为离散随机变量，其支集为 $S_1$，$Y$ 为另一个离散随机变量，其支集为 $S_2$。设 $X$ 和 $Y$ 的联合 PMF 为 $f(x,y)$，支集为 $S$。则单独 $X$ 的PMF，称为 $X$ 的**边缘 PMF**，定义为：
$$f_X(x)=\sum_yf(x,y)=P(X=x), \qquad x\in S_1$$
对支集 $S_1$ 中每个 $x$，对 $y$ 的所有可能值进行求和。

类似地，单独 $Y$ 的PMF，称为 $Y$ 的**边缘 PMF**，定义为： 

$$f_Y(y)=\sum_xf(x,y)=P(Y=y), \qquad x\in S_2$$
对支集 $S_2$ 的每个 $y$，对 $x$ 的所有可能值求和。

再次回头看联合 PMF 的表格形式，可以发现对所有 $x\in S_1$，$y\in S_2$，有：

$$P(X=x,Y=y)=\frac{1}{16}=P(X=x)\cdot P(Y=y)=\frac{1}{4}\cdot\frac{1}{4}=\frac{1}{16}$$
**当出现该情况，我们说 $X$ 和 $Y$ 相互独立**。下面给出两个随机变量 $X$ 和 $Y$ 相互独立的正式定义。

### 独立随机变量

随机变量 $X$ 和 $Y$ 是独立的，当且仅当：

$$P(X=x,Y=y)=P(X=x)\times P(Y=y)$$
其中 $x\in S_1$, $y\in S_2$。否则认为 $X$ 和 $Y$ 相关。

**计算均值**

现在，假设我们已知联合 PMF 函数 $f(x,y)$，需要计算 $X$ 的均值。一种方法是求出 $X$ 的边缘 PMF，然后根据单变量的方法计算均值 $E(X)$。另外，也可以使用下面扩展到联合 PMF 的均值定义。

**定义：** 设 $X$ 为离散随机变量，支集为 $S_1$；$Y$ 为另一个离散随机变量，支集为 $S_2$。设 $X$ 和 $Y$ 在支集 $S$ 上的联合 PMF 函数为 $f(x,y)$。如果 $\mu(X,Y)$  是这两个随机变量的函数，设：

$$E[\mu(X,Y)]=\sum\sum_{(x,y)\in S}\mu (x,y)f(x,y)$$
如果该值存在，就称其为 $\mu(X,Y)$ 的期望值。

```ad-note
这里 $\mu(X,Y)$ 是 $X$ 和 $Y$ 的函数，即上式定义的是关于 $X$ 和 $Y$ **函数的期望值**。
```

如果 $\mu(X,Y)=X$，得到 $X$ 的均值：
$$\mu_X=E[X]=\sum\sum_{x\in S_1, y\in S2}xf(x,y)$$
如果 $\mu(X,Y)=Y$，得到 $Y$ 的均值：
$$\mu_Y=E[Y]=\sum\sum_{x\in S_1, y\in S2}yf(x,y)$$
回到最初的例子，假设投掷一对均匀的四面骰子🎲，一个骰子是红色，一个是黑色。令：

- $X=$ 红色骰子的结果 $={1,2,3,4}$
- $Y=$ 黑色骰子的结果 $={1,2,3,4}$

那么 $X$ 和 $Y$ 的均值分别是多少？

**解：** $X$ 的均值为：
$$
\begin{aligned}
\mu_X=E[X]&=\sum_{x\in S_1}\sum_{y\in S_2}xf(x,y)\\
&=1(\frac{1}{16})+\cdots+1(\frac{1}{16})+\cdots+4(\frac{1}{16})+\cdots+4(\frac{1}{16})
\end{aligned}
$$
可以简化为：
$$
\mu_X=E[X]=1(\frac{4}{16})+2(\frac{4}{16})+3(\frac{4}{16})+4(\frac{4}{16})=\frac{40}{16}=2.5
$$
$Y$ 的均值以相同方法计算：
$$
\begin{aligned}
\mu_Y=E[Y]&=\sum_{x\in S_1}\sum_{y\in S_2}yf(x,y)\\
&=1(\frac{1}{16})+\cdots+1(\frac{1}{16})+\cdots+4(\frac{1}{16})+\cdots+4(\frac{1}{16})
\end{aligned}
$$
简化为：
$$
\mu_Y=E[Y]=1(\frac{4}{16})+2(\frac{4}{16})+3(\frac{4}{16})+4(\frac{4}{16})=\frac{40}{16}=2.5
$$
可以发现，$X$ 的均值计算公式被简化为：
$$\mu_X=\sum_{x\in S_1}xf(x)$$
这是因为：
$$\mu_X=E[X]=\sum_{x\in S_1}\sum_{y\in  S_2}xf(x,y)=\sum_{x\in S_1}x\sum_{y\in S_2}f(x,y)=\sum_{x\in S_1}xf(x)$$
上式第三个等号成立，是因为 $x$ 不依赖于 $y$，因此可以通过 $y$ 求和提出来。最后一个等号则是 $X$ 的边缘 PMF 定义。类似地，$Y$的均值为：
$$\mu_Y=\sum_{y\in S_2}yf(y)$$
**计算方差**

现在，假设已知联合 PMF 函数 $f(x,y)$，需要计算 $X$ 的方差。同样，一种策略是先确定 $X$ 的边缘 PMF，然后使用单变量方差 $Var(X)$ 的计算公式。也可以使用下面扩展到联合 PMF 定义的方差。

**定义：** 设 $X$ 为支集 $S_1$ 上的离散随机变量，$Y$ 为支集 $S_2$ 上的离散随机变量。设 $X$ 和 $Y$ 在支集 $S$ 上的联合 PMF 函数为 $f(x,y)$。如果 $\mu(X,Y)$ 是这两个随机变量的函数，则：

$$E[\mu(X,Y)]=\sum\sum_{(x,y)\in S}\mu (x,y)f(x,y)$$
如果该值存在，就称其为 $\mu(X,Y)$ 的期望值。如果 $\mu(X,Y)=(X-\mu_X)^2$，则：
$$\sigma_X^2=Var[X]=\sum_{x\in S_1}\sum_{y\in S_2}(x-\mu_X)^2f(x,y)$$
如果存在，则为 $X$ 的方差。$X$ 的方差也可以用下面的快捷公式计算：
$$\sigma_X^2=E(X^2)-\mu_X^2=\lgroup\sum_{x\in S_1}\sum_{y\in S_2}x^2f(x,y)\rgroup-\mu_X^2$$
同理，$Y$ 的方差为：
$$\sigma_Y^2=E(Y^2)-\mu_Y^2=\lgroup\sum_{x\in S_1}\sum_{y\in S_2}y^2f(x,y)\rgroup-\mu_Y^2$$
依然以骰子为例，$X$ 的方差为：
$$\sigma_X^2=\sum_{x\in S_1}\sum_{y\in S_2}(x-\mu_X)^2f(x,y)=(1-2.5)^2(\frac{1}{16}+\cdots+(4-2.5)^2(\frac{1}{16}))=1.25$$
快捷公式计算：
$$
\begin{aligned}
\sigma_X^2&=E(X^2)-\mu_X^2\\
&=\lgroup\sum_{x\in S_1}\sum_{y\in S_2}x^2f(x,y)\rgroup-\mu_X^2\\
&=[1^2(\frac{1}{16})+\cdots+4^2(\frac{1}{16})]-2.5^2\\
&=\frac{120}{16}-6.25=1.25
\end{aligned}
$$
## 3. 三角支集

两个随机变量 $X$ 和 $Y$ 相互独立，对所有 $x\in S_1$ 和 $y\in S_2$ 要满足：
$$P(X=x,Y=y)=P(X=x)\times P(Y=y)$$
否则认为 $X$ 和 $Y$ 是相关的。上一节介绍的随机变量 $X$ 和 $Y$ 相互独立，这一节介绍两个相关的随机变量 $X$ 和 $Y$。

以下面的联合 PMF 为例：
$$f(x,y)=\frac{xy^2}{13}$$
其支集为 $S={(x,y)}={(1,1),(1,2),(2,2)}$。那么随机变量 $X$ 和 $Y$ 是否独立？

**解：** 这里给出了联合 PMF 的公式。因此可以很容易地计算出支集 $S$ 中每个 $(x,y)$ 的联合概率：
$$
\begin{gather}
当 x=1, y=1: f(1,1)=\frac{(1)(1)^2)}{13}=\frac{1}{13}\\
当 x=1, y=2: f(1,2)=\frac{(1)(2)^2)}{13}=\frac{4}{13}\\
当 x=2, y=2: f(2,2)=\frac{(2)(2)^2)}{13}=\frac{8}{13}
\end{gather}
$$
计算完联合概率，下面制作表格形式的 PMF，并加上 $X$ 和 $Y$ 的边缘 PMF：

![[Pasted image 20230525091821.png|350]]

可以看到， $X$ 和 $Y$ 的联合支集 $S$ 的形状像个三角形，故称其为**三角支集**：

![[Pasted image 20230525092138.png|350]]

另外，很容易验证 $X$ 和 $Y$ 是相关的，因为：
$$f(1,2)=\frac{4}{13}\ne f_X(1)\cdot f_Y(2)=\frac{5}{13}\times\frac{12}{13}$$
一般来说，任意两个随机变量 X 和 Y 具有联合三角支集，说明它们相关，因为总有：
$$f(x)\times f(y)=c\ne 0$$
对非零常数 c，上面的联合 PMF：
$$f_X(2)\times f_Y(1)=(\frac{8}{13})\times(\frac{1}{13})=\frac{8}{169}\ne 0=f_{X,Y}(2,1)$$
而具有矩形支集的随机变量可能独立，也可能相关。

## 4. 三项分布

二项分布（binomial distribution）描述了离散随机变量 $X$ 的行为，其中 $X$ 是 $n$ 次试验中成功的次数，每次试验只有两种结果。那么，如果每次试验有三种结果，会发生什么？这里讨论这种情况。

假设随机选择 $n=20$ 名学生：

- 事件 A 表示随机选择的学生周六去看足球赛，其概率设为 $P(A)=0.20=p_1$
- 事件 B 表示随机选择的学生周六在电视上看足球赛，其概率设为 $P(B)=0.50=p_2$
- 事件 C 表示随机选择的学生周六不看足球塞，其概率 $P(C)=0.3=1-p_1-p_2$

随机选择的 20 名学生的一个可能结果是：

**BBCABBAACABBBCCBCBCB**

即前两个学生在电视上看比赛，第三个学生不看比赛，第四个学生去现场看比赛等等，假设：

- $X$ 是周六去看足球赛的人数，4 个 A 对应 $X=4$
- $Y$ 是周六在电视上看足球赛的人数，10 个 B 对应 $Y=10$
- $Z$ 是不看足球赛的人数，6 个 C 对应 $Z=6$

### X 和 Y 的联合 PMF

如何计算 $X$ 和 $Y$ 的联合 PMF？

以生成 BBCABBAACABBBCCBCBCB 序列为例，其概率为：
$$\frac{20!}{4!10!6!}p_1^4p_2^{10}(1-p_1-p_2)^6=P(X=4,Y=10)$$
以此类推，$X$ 和 $Y$ 的联合 PMF 为：
$$f(x,y)=P(X=x,Y=y)=\frac{n!}{x!y!(n-x-y)!}p_1^xp_2^y(1-p_1-p_2)^{n-x-y}$$
其中，$x=0,1,...,n$，$y=0,1,...,n$，且 $x+y\le n$。

**定义：** 假设我们独立重复一个试验 n 次，每次试验有三种互斥的结果，分别表示为成功、失败一号和失败二号。设 $X$ 为成功次数，$Y$ 为失败一号次数，$Z$ 为失败二号次数，则 $X$ 和 $Y$ 的联合 PMF 为：
$$f(x,y)=P(X=x,Y=y)=\frac{n!}{x!y!(n-x-y)!}p_1^xp_2^y(1-p_1-p_2)^{n-x-y}$$
其中，$x=0,1,..,n$， $y=0,1,...,n$， $x+y\le n$。

### X 和 Y 的边缘 PMF

如何计算 $X$ 和 $Y$ 的边缘 PMF，以及 $X$ 和 $Y$ 是否相互独立？

如果将失败一号和失败二号归为一类，$X$ 为成功次数，就变成了二项分布问题，其参数为 $n$ 和 $p_1$。即：
$$f(x)=\frac{n!}{x!(n-x)!}p_1^x(1-p_1)^{n-x}$$
其中，$x=0,1,...,n$。同样地，我们可以将成功和失败二号合并，此时 $Y$ 成了二项分布，其参数为 $n$ 和 $p_2$。即：
$$f(y)=\frac{n!}{y!(n-y!)}p_2^y(1-p_2)^{n-y}$$
其中，$y=0,1,...,n$。

我们还可以得出 X 和 Y 是相关的结论，因为将 X 和 Y 的边缘 PMF 相乘，得到的不是三项分布的 PMF。即 $f(x,y)\ne f(x)\times f(y)$：
$$\frac{n!}{x!y!(n-x-y)!}p_1^xp_2^y(1-p_1-p_2)^{n-x-y}\ne [\frac{n!}{x!(n-x)!}p_1^x(1-p_1^{n-x})]\times[\frac{n!}{y!(n-y)!}p_2^y(1-p2)^{n-y}]$$
另外，X 和 Y 的联合支集为三角形，也能说明它们是相关的。
