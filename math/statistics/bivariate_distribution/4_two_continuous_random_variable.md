# 两个连续随机变量的分布

2023-05-29
****
## 1. 简介

设 $X$ 和 $Y$ 是连续随机变量。例如，美国黄石公园有个叫作老忠实间歇泉（Old Faithful Geyser）的喷泉，设 $X$ 为一次喷发持续的时间（秒），$Y$ 表示与下一次喷发的时间间隔（分钟）。现在想知道 $X$ 和 $Y$ 是否相关。或者， $X$ 落在 $a$ 和 $b$ 之间，$Y$ 落在 $c$ 和 $d$ 之间的概率 $P(a<x<b, c<Y<d)$。

主要内容：

- 两个连续随机变量的联合概率密度函数（Probability Density Function, PDF）
- 使用联合 PDF 计算特定事件的概率
- 从 $X$ 和 $Y$ 的联合 PDF 计算连续随机变量 $X$ 的边缘 PDF
- 从 $X$ 和 $Y$ 的联合 PDF 计算连续随机变量 $X$ 和 $Y$ 的均值和方差
- 给定连续随机变量 $X$ 时连续时间变量 $Y$ 的条件概率密度函数
- 连续随机变量的条件均值和方差

## 2. 两个连续随机变量

下面介绍连续随机变量的联合 PDF，边缘 PDF，期望以及独立性的定义。

### 联合概率密度函数

设 $X$ 和 $Y$ 是两个连续随机变量，$S$ 是 $X$ 和 $Y$ 的二维支集。如果函数 $f(x,y)$ 如果满足下面三个条件，就是联合概率密度函数（PDF）：

$$f(x,y)\ge 0$$
$$\int^{\infty}_{-\infty}\int^{\infty}_{-\infty}f(x,y)dxdy=1$$
$$P[(X,Y)\in A]=\int \int_A f(x,y)dxdy \qquad \{(x,y)\in A\} \text{是 xy 平面的一个事件}$$

1. 函数值非负，即 $f(x,y)$ 是 $xy$ 平面上方的一个二维平面。
2. 支集定义的体积，即 $f(x,y)$ 函数平面和 $xy$ 平面之间的体积为 1。
3. 为了确定事件 A 的概率，必须在事件 A 定义的空间上对 $f(x,y)$ 积分。

计算单个连续随机变量的相关概率需要计算曲线下的**面积**。类似地，计算两个连续随机变量相关事件的概率需要计算事件 A 定义的平面 $f(x,y)$ 与 $xy$ 平面之间的**体积**。

**问题一：** 设 $X$ 和 $Y$ 的联合概率密度函数为：

$$f(x,y)=4xy$$
其中 $0<x<1$，$0<y<1$，那么 $f(x,y)$ 是否是有效的 PDF？

在验证 $f(x,y)$ 是否是有效的 PDF 之前，可视化函数有助于理解问题：

![[Pasted image 20230526164313.png|350]]
> 这个图貌似有点问题。

红色方框是 $X$ 和 $Y$ 在 $xy$ 平面的联合支集。蓝线是对 $f(x,y)$ 平面的演示。为了验证 $f(x,y)$ 是否为有效的 PDF，首先要确定 $f(x,y)$ 非负。显然，$f(x,y)$ 平面在 $xy$ 平面上方， $0<x<1$，$0<y<1$，$f(x,y)=4xy$ 自然非负。

现在只需证明 $f(x,y)$ 平面和 $xy$ 平面之间的体积为 1：

$$
\begin{aligned}
\int^{1}_{0}\int^{1}_{0}4xydxdy&=\int^{1}_{0}4y[\frac{x^2}{2}]_{x=0}^{x=1}dy \\
&=\int^{1}_{0}4y(\frac{1}{2})dy \\
&=\int^{1}_{0}2ydy\\
&=[y^2]_{y=0}^{y=1}\\
&=1^2-0^2=1
\end{aligned}
$$

**问题二：** $P(Y<X)$ 是多少？

为了计算所需概率，我们需要确定由 $xy$ 平面和支集定义平面之间的体积。不过，这一次不是完整的正方形 $xy$ 平面，而是 $y<x$ 区域。如下蓝色区域所示：

![[Pasted image 20230529085415.png|350]]

$$
\begin{aligned}
P(Y<X)&=\int^{1}_{0}\int^{x}_{0}4xydydx \\
&=\int^{1}_{0}[4x(\frac{y^2}{2})]_{y=0}^{y=x}dx \\
&=\int^{1}_{0}4x(\frac{x^2}{2}-0)dx \\
&=\int^{1}_{0}2x^3dx \\
&=[2(\frac{x^4}{4})]_{x=0}^{x=1}=\frac{1}{2}
\end{aligned}
$$
### 边缘概率密度函数

连续随机变量 $X$ 和 $Y$ 的边缘概率密度函数（marginal probability density function）分别为：

$$f_X(x)=\int^{\infty}_{-\infty}f(x,y)dy, \qquad x\in  S_1$$
$$f_Y(y)=\int^{\infty}_{-\infty}f(x,y)dx, \qquad y \in S_2$$
其中 $S_1$ 和 $S_1$ 分别为 $X$ 和 $Y$ 的支集。

**问题三：** 设 X 和 Y 的联合概率密度函数为：

$$f(x,y)=4xy$$
其中 $0<x<1$，$0<y<1$，那么 $X$ 的边缘 PDF $f_X(x)$ 和 $Y$ 的边缘 PDF $f_Y(y)$ 分别为？

为了获得 $X$ 的边缘 PDF，需要将联合 PDF $f(x,y)$ 对 $0<y<1$ 积分，即对 $Y$ 的支集积分：
$$f_X(x)=\int^{1}_{0}4xydy=4x[\frac{y^2}{2}]_{y=0}^{y=1}=2x, \qquad 0<x<1$$
同理，$Y$ 的边缘 PDF 为：

$$f_Y(y)=\int^{1}_{0}4xydx=4y[\frac{x^2}{2}]_{x=0}^{x=1}=2y,\qquad 0<y<1$$
### 期望值

根据 $X$ 和 $Y$ 的联合 PDF计算连续随机变量 $X$ 的期望值：

$$E(X)=\int^{\infty}_{-\infty}\int^{\infty}_{-\infty}xf(x,y)dxdy$$
类似的，根据 $X$ 和 $Y$ 的联合 PDF 计算连续随机变量 $Y$ 的期望值：

$$E(Y)=\int^{\infty}_{-\infty}\int^{\infty}_{-\infty}yf(x,y)dydx$$
**问题四：** 设 $X$ 和 $Y$ 的联合概率密度函数为：

$$f(x,y)=4xy$$
其中 $0<x<1$，$0<y<1$，那么 $X$ 和 $Y$ 的期望值分别是多少？

$$
\begin{aligned}
E(X)&=\int^{1}_{0}\int^{1}_{0}x\cdot 4xydxdy\\
&=\int^{1}_{0}\int^{1}_{0}4x^2ydxdy \\
&=\int^{1}_{0}4y[\frac{x^3}{3}]_{x=0}^{x=1}dy \\
&=\int^{1}_{0}4y(\frac{1}{3})dy \\
&=\frac{4}{3}\int^{1}_{0}ydy \\
&=\frac{4}{3}[\frac{y^2}{2}]^{y=1}_{y=0}\\
&=\frac{2}{3}
\end{aligned}
$$

$Y$ 的期望值也是 $\frac{2}{3}$，计算过程相同。

### 相互独立

当且仅当连续随机变量 $X$  和 $Y$ 的联合 PDF 为 $X$ 和 $Y$ 的边缘 PDF 乘积，$X$ 和 $Y$ 相互独立（independent），即：

$$f(x,y)=f_X(x)f_Y(y), \qquad x\in S_1, \quad y\in S_2$$
**问题五：** 设 $X$ 和 $Y$ 的联合概率密度函数为：

$$f(x,y)=4xy$$
其中 $0<x<1$，$0<y<1$，那么 $X$ 和 $Y$ 是否独立？

$X$ 和 $Y$ 是独立的，因为：

$$f(x,y)=4xy=f_X(x)f_Y(y)=(2x)(2y)=4xy$$
在该例中，$X$ 和 $Y$ 的支集为矩形，且 $X$ 和 $Y$ 独立。

```ad-attention
离散与连续的情况相同，即如果 $X$ 和 $Y$ 的支集 $S$ 为三角形，那么 $X$ 和 $Y$ 不独立；如果支集为矩形，则无法确定 $X$ 和 $Y$ 是否独立。
```

**问题六：** 设 $X$ 和 $Y$ 的联合概率密度函数为：

$$f(x,y)=x+y$$
其中 $0<x<1$，$0<y<1$，那么 $X$ 和 $Y$ 是否独立？

为了确定 $X$ 和 $Y$ 是否独立，需要确定 $X$ 和 $Y$ 的联合 PDF 是否为两者的边缘 PDF 乘积。$X$ 的边缘 PDF 为：

$$f_X(x)=\int^{1}_{0}(x+y)dy=[xy+\frac{y^2}{2}]^{y=1}_{y=0}=x+\frac{1}{2},\qquad 0<x<1$$
$Y$ 的边缘 PDF 为：

$$f_Y(y)=\int^{1}_{0}(x+y)dx=[\frac{x^2}{2}+xy]^{x=1}_{x=0}=y+\frac{1}{2},\qquad 0<y<1$$
显然，$X$ 和 $Y$ 不独立（dependent）：

$$f(x,y)=x+y\ne f_X(x)f_Y(y)=(x+\frac{1}{2})(y+\frac{1}{2})$$
它们的支集为矩形：

![[Pasted image 20230529095111.png|350]]


## 3. 连续随机变量的条件分布

条件分布很容易从离散随机变量扩展到连续随机变量。

### 条件分布

**定义：** 假设 $X$ 和 $Y$ 为连续随机变量，联合 PDF 为 $f(x,y)$，边缘 PDF 分别为 $f_X(x)$ 和 $f_Y(y)$。则在 $X=x$ 时 $Y$ 的条件概率密度函数为：

$$h(y|x)=\frac{f(x,y)}{f_X(x)}$$

其中 $f_X(x)>0$。

给定 $X=x$ 时 $Y$ 的条件均值为：

$$E(Y|x)=\int^{\infty}_{-\infty}yh(y|x)dy$$
给定 $X=x$ 时 $Y$ 的条件方差为：

$$Var(Y|x)=E\{[Y-E(Y|x)]^2|x\}=\int^{\infty}_{-\infty}[y-E(Y|x)]^2h(y|x)dy$$
或者：

$$Var(Y|x)=E[Y^2|x]-[E(Y|x)]^2=[\int^{\infty}_{-\infty}y^2h(y|x)dy]-\mu^2_{Y|x}$$

$X$ 和条件均值和条件方差的定义类似，这里不再赘述。

**问题七：** 设连续随机变量 $X$ 和 $Y$ 满足如下条件概率密度函数：

$$f(x,y)=\frac{3}{2}$$
其中，$x^2\le y\le 1$，$0<x<1$。那么给定 $X=x$ 时 $Y$ 的条件分布？

使用公式：

$$h(y|x)=\frac{f(x,y)}{f_X(x)}$$

要计算 $X$ 的边缘 PDF $f_X(x)$，需要在 $Y$ 的支集 $S_2$ 上对联合 PDF $f(x,y)$ 积分。下图是联合支集 $S$ 的示意图：

![[Pasted image 20230529101754.png|350]]

即有一个形状类似支集的平面，在 $xy$  平面上方 $\frac{3}{2}$ 的位置。要计算 $f_X(x)$，需要在支集 $x^2\le y \le 1$ 对其积分：

$$f(x,y)=\frac{3}{2}$$
即：

$$f_X(x)=\int_{S_2}f(x,y)dy=\int^{1}_{x^2}\frac{3}{2}dy=[\frac{3}{2}y]_{y=x^2}^{y=1}=\frac{3}{2}(1-x^2)$$
其中，$0<x<1$。

然后用联合 PDF $f(x,y)$ 和边缘 PDF $f_X(x)$ 计算给定 $X=x$ 时 $Y$ 的条件 PDF：

$$h(y|x)=\frac{f(x,y)}{f_X(x)}=\frac{\frac{3}{2}}{\frac{3}{2}(1-x^2)}=\frac{1}{(1-x^2)}, \qquad 0<x<1, \quad x^2\le y\le 1$$
所以，给定 $x$，连续随机变量 $Y$ 是区间  $(x^2, 1)$ 的均匀分布。例如，如果 $x=\frac{1}{4}$，那么 $Y$ 的 条件 PDF 是：

$$h(y|\frac{1}{4})=\frac{1}{1-(\frac{1}{4})^2}=\frac{16}{15}$$
其中 $\frac{1}{16}\le y\le 1$。如果 $x=\frac{1}{2}$，则 $Y$ 的条件 PDF 为：

$$h(y|\frac{1}{2})=\frac{1}{1-(\frac{1}{2})^2}=\frac{1}{1-(\frac{1}{4})}=\frac{4}{3}$$
其中，$\frac{1}{4}\le y \le 1$。

### 条件均值


$$
\begin{aligned}
E(Y|x)&=\int^{1}_{x^2}yh(y|x)dy \\
&=\int^{1}_{x^2}y(\frac{1}{1-x^2})dy \\
&=\frac{1}{1-x^2}\int^{1}_{x^2}ydy \\
&=\frac{1}{1-x^2}[\frac{y^2}{2}]_{y=x^2}^{y=1} \\
&=\frac{1}{1-x^2}[\frac{1}{2}-\frac{x^4}{2}] \\
&=\frac{1+x^2}{2}
\end{aligned}
$$
如前所述，给定 $X=x$ 时 $Y$ 的条件分布为区间 $(x^2,1)$ 的均匀分布，所以不意外，这个期望值与均匀随机变量的一致。

当 $x=\frac{1}{2}$，$Y$ 的条件分布为：

$$h(y|\frac{1}{2})=\frac{1}{1-(\frac{1}{2})^2}=\frac{1}{1-(\frac{1}{4})}=\frac{4}{3}$$
其中，$\frac{1}{4}\le y \le 1$。此时 $Y$ 的条件均值为：

$$E(Y|\frac{1}{2})=\frac{1+(\frac{1}{2})^2}{2}=\frac{5}{8}$$

如下图所示：

![[Pasted image 20230529105027.png|350]]

