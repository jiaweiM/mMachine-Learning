# ANOVA

2020-07-09, 08:14
***

## 简介

方差分析(Analysis of Variance, **ANOVA**)，用于两个或两个以上样本平均值差别的显著性检验。由于各种因素的影响，研究所得的数据呈现波动状。造成波动的原因可分成两类，一是不可控的随机因素，另一是研究中施加的对结果形成影响的可控因素。

假如有一组数据：

|Sample|1|2|3|
|---|---|---|---|
|Data|3|5|5|
||2|3|6|
||1|4|7|
|均值|

## 单因素试验的方差分析

在科学试验和生产实践中，影响事物的因素有很多，有些因素影响较大，有些较小。方差分析对试验的结果进行分析，鉴别各个相关因素对试验结果影响的有效方法。

在试验中考察的指标称为**试验指标**。影响试验指标的条件称为**因素**。因素可以分为两类，一类是人们可以控制的（可控因素）；一类是人们不能控制的。如反应温度、原料剂量、溶液浓度等是可控的，而测量误差、气象条件等则难以控制。

以下讨论的因素均指可控因素。因素所处的状态，称为该因素的**水平**。如果在一项试验中只有一个因素改变称为**单因素试验**，如果有多个因素在改变称为**多因素试验**。

例如：三台机器，成产规格相同的铝合金薄板。取样，测量薄板的洪都精确至千分之一厘米。得如下结果：

|机器I|机器II|机器III|
|---|---|---|
|0.236|0.257|0.258|
|0.238|0.253|0.264|
|0.248|0.255|0.259|
|0.245|0.254|0.267|
|0.243|0.261|0.262|

这里试验的指标是薄板的厚度，机器是因素，不同的三台机器就是这个因素的三个不同水平。我们假定除机器外，其他因素都相同，这是单因素试验，试验的目的是考察各台机器所生产的薄板的厚度有无显著差异，即考察机器这一因素对厚度有无显著的影响。如果厚度有显著差异，就表明机器这一因素对厚度的影响是显著的。

我们在因素的每一个水平下进行独立试验，其结果是一个样本。表中数据可看成来自三个不同总体（每个水平对应一个总体）的样本值。将各个总体的均值一次记为 $\mu_1$, $\mu_2$, $\mu_3。按题意需检验假设：

$$H_0: \mu_1=\mu_2=\mu_3$$
$$H1: \mu_1, \mu_2, \mu_3 不全相等$$

然后继续假设各总体均为正态变量，各总体的方差相等，但参数均未知。

现在这是一个检验同方差的多正态总体均值均值是否相等的问题。下面要讨论的方差分析法，就是解决这类问题的一个统计方法。

设因素 A 有 s 个水平 $A_1$, $A_2$,..., $A_s$， 在水平 $A_j$ (j=1,2,...,s)下，进行 $n_j (n_j\geq2)$ 次独立试验，得到如下结果：

|水平|$A_1$|$A_2$|$\dots$|$A_s$|
|---|:---:|:---:|:---:|:---:|
||$A_{11}$|$A_{12}$|$\dots$|$A_{1s}$|
||$\vdots$|$\vdots$||$\vdots$|
||$A_{21}$|$A_{22}$|$\dots$|$A_{2s}$|
||$A_{n_11}$|$A_{n_22}$|$\dots$|$A_{n_ss}$|
|样本总和|$T_1$|$T_2$|$\dots$|$T_s$|
|样本均值|$\overline{X}_1$|$\overline{X}_2$|$\dots$|$\overline{X}_s$|
|总体均值|$\mu_1$|$\mu_2$|$\dots$|$\mu_s$|

我们假定各个水平 $A_j (j=1,2,...,s)$ 下的样本 $X_{1j}, X_{2j},..., X_{n_jj}$ 来自具有相同方差 $\sigma^2$，均值分别为 $u_j (j=1,2,...,s)$ 的正态总体 $N(\mu_j,\sigma^2)$，$\mu_j$ 与 $\sigma^2$ 未知。且设不同水平 $A_j$ 下的样本之间相互独立。

由于 $X_{ij} \text{\textasciitilde} N(\mu_j, \sigma^2)$，即 $(X_{ij}-\mu_j) \text{\textasciitilde} N(0, \sigma^2)$，所以可以将 $X_{ij}-\mu_j$ 看成随机误差。记 $X_{ij}-\mu_j=$