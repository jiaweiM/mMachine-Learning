# 机器学习项目清单

- [机器学习项目清单](#机器学习项目清单)
  - [简介](#简介)
  - [提出问题，从全局考虑](#提出问题从全局考虑)
  - [获取数据](#获取数据)
  - [查看、了解数据](#查看了解数据)
  - [准备数据](#准备数据)
  - [候选模型](#候选模型)
  - [微调系统](#微调系统)
  - [展示你的解决方案](#展示你的解决方案)
  - [启动](#启动)

2022-03-22, 22:42
***

## 简介

这个检查表是辅助完成机器学习项目。主要有 8 个步骤：

1. 提出问题，从全局考虑；
2. 获取数据；
3. 查看数据，了解数据；
4. 准备数据，以更好地将底层数据模式展示给机器学习算法；
5. 尝试不同的模型，并列出最佳模型；
6. 微调模型，并将它们组合成一个好的解决方案；
7. 展示解决方案；
8. 启动、监控和维护你的系统。

## 提出问题，从全局考虑

1. 以业务术语定义目标（准确定义目标很重要）；
2. 你的解决方案将如何使用？
3. 目前的解决方案/解决方法（如果有）是什么？
4. 如何界定这个问题（监督/无监督，在线/离线等）？
5. 如何衡量性能？
6. 性能指标与业务目标是否一致？
7. 达到业务目标所需的最低性能？
8. 有没有类似的问题？是否能使用已有经验或工具？
9. 人类专业知识是否可用？
10. 如何手动解决这个问题？
11. 列出到目前为止你所做的假设。
12. 如果可能，验证假设。

## 获取数据

> 这一步尽可能的自动化

1. 列出你所需的数据，以及需要多少？
2. 查找并记录在哪里获取数据
3. 检查它所需空间
4. 检查法律义务，必要时获得授权
5. 获取访问权限
6. 创建工作空间（足够的存储空间）
7. 获取数据（尽量写成函数来自动化该过程）
8. 将数据转换为你可以轻松操作的格式（不要更改数据本身）
9. 确保删除或保护敏感信息
10. 检查数据大小和类型（时间序列、样本、地理位置等）
11. 对数据集进行采样作为**测试集**，将其放在一边不要查看

要稳定的拆分训练集和测试集，使用每个样本的标志符来决定它是否应该作为测试样本是一个常用方法。例如，计算每个样本识别符的哈希值，如果哈希值小于或等于最大哈希值的 20%，则将该样本放到测试集。这样确保测试集在多次运行中保持一致。

可以考虑使用 `sklearn.model_selection.train_test_split` 拆分测试集。

## 查看、了解数据

> 尽量从领域专家获取这些步骤的见解

1. 创建数据副本用于查看（必要时可以抽样，避免数据太大）
2. 创建 Jupyter notebook，以记录查看数据的过程
3. 研究每个属性及其特征：
   - 名称
   - 类型（分类，int/float，有界/无界，文本，结构化）
   - 缺失值比例
   - 噪音和噪音类型（随机、异常、舍入误差等）
   - 对任务是否有用
   - 分布类型（高斯分布、均匀分布、对数分布等）
4. 对监督学习任务，确定目标属性
5. **可视化数据**
6. 研究属性之间的相关性
7. 研究如何手动解决问题
8. 确定你可能需要执行的数据转换
9. 确定额外有用的数据（回到 [获取数据](#获取数据))
10. 记录你学到的东西。

## 准备数据

注意事项：

- 在数据副本上操作（保持原始数据的完整）
- 为所有数据转换编写函数，原因有五：
  - 下次获取新数据集时可以轻松准备数据；
  - 在未来的项目中也可以应用这些转换；
  - 清理和准备测试集；
  - 解决方案启动后，清理和准备新数据实例；
  - 更容易将准备选项作为超参数。

1. 数据清理
   - 修复或删除异常值（可选）；
   - 填充缺失值（如使用零、均值、中位数填充）或删除对应行或列
2. 特征选择（可选）
   - 删除对任务没用的属性
3. 特征工程
   - 将连续特征离散化
   - 分解特征（如分类、日期等）
   - 添加所需特征转换（如 log(x), sqrt(x) 等）
   - 将特征聚合成有用的新特征
4. 特征缩放
   - 标准化或规范化特征

## 候选模型

注意事项：

- 如果数据集很大，可能需要抽样出一个小的训练集，以便在合理的时间内训练许多不同的模型（需要注意，这样对大型神经网络或随机森林等复杂模型不利）
- 再一次，尽可能自动化这些步骤。

1. 使用标准参数训练许多不同类别（如 linear, naive Bayes, SVM, Random Forest, neural net 等）的 quick-and-dirty 模型；
2. 衡量并比较它们的性能
   - 对每个模型，使用 N-fold 交叉验证，计算 N 个 folds 上模型性能的均值和标准差
3. 分析每个算法最重要的变量
4. 分析模型产生的错误类型
   - 人类会用什么样的数据来避免这些错误？
5. 执行一轮快速的特征选择和工程
6. 对前面的五个步骤执行1到2个快速迭代
7. 选择三到五个最佳模型，优先选择出现不同错误类型的模型。

## 微调系统

注意事项：

- 这一步使用尽可能多的数据，尤其是微调即将结束时。
- 一如既往，尽可能地自动化。

1. 使用交叉验证微调超参数：
   - 将数据转换选项视为超参数，特别是不确定时（例如，不确定是否用零或中值替换缺失值，或直接删除行）
   - 除非超参数很少，否则最好选择随机搜索而不是网格搜索。如果训练时间很长，可以考虑用贝叶斯优化方法
2. 尝试集成方法。结合多个最佳模型通常比单独使用某一个性能更好
3. 一旦你对最终模型有信心，就可以在测试集上测量它的性能来估计泛化误差。

## 展示你的解决方案

1. 记录你所做的事情
2. 创建一个漂亮的 PPT
   - 确保突出重点
3. 解释为什么你的解决方案实现了业务目标
4. 不要忘了展示在此过程中你发现的有趣点
   - 描述哪些有效，哪些无效
   - 列出你的假设和你系统的局限性
5. 确保你的关键发现通过漂亮的可视化表达或容易记住的语句进行描述

## 启动

1. 为解决方案准备好生产，包括生产数据输入、编写单元测试等
2. 编写监控代码，定期检查系统的实时性能，并在系统出问题时触发警报。
   - 谨防退化：随着数据的发现，模型往往会慢慢变烂
   - 测量性能可能需要人工管道（如，通过众包服务）
   - 还要监控输入质量，例如，发送随机值的传感器出现故障，或者其它团队的输出变得陈旧。这对于在线学习系统尤为重要。
3. 定期根据新数据对模型进行重新训练（尽可能自动化）
