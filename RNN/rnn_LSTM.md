# 长短期记忆网络（LSTM）

- [长短期记忆网络（LSTM）](#长短期记忆网络lstm)
  - [门控记忆元](#门控记忆元)
    - [门](#门)
  - [参考](#参考)

2022-01-10, 13:24
***

## 门控记忆元

长短期记忆网络（long short-term memoRY, LSTM）的设计灵感来自计算机的逻辑门。LSTM 引入记忆元（memory cell），或简称为单元（cell）。为了控制记忆元，需要许多门：

- 用来从单元中输出条目的门，称为输出门（output gate）；
- 用来决定何时将数据读入单元，称为输入门（input gate）；
- 用来重置单元的内容，称为遗忘门（forget gate）。

LSTM 记忆元结构如下：

![](images/2022-01-10-13-14-38.png)

### 门

当前时间步的输入和前一个时间步的*隐状态*作为数据送入 LSTM 的门中，如下图所示：

![](images/2022-01-10-13-25-20.png)

它们由三个具有 sigmoid 激活函数的全连接层处理，以计算输入门、遗忘门和输出门的值。因此，这三个门的值都在 (0,1) 之间。

假设有 $h$ 个隐藏单元，

- 输入门

$$I_t=\sigma(X_t W_{xi}+H_{t-1}W_{hi}+b_i)$$

决定要不要忽略输入数据

- 忘记门

$$F_t=\sigma(X_tW_{xf}+H_{t-1}W_{hf}+b_f)$$

将值朝 0 减少

- 输出门

$$O_t=\sigma(X_tW_{xo}+H_{t-1}W_{ho}+b_o)$$

决定要不要使用隐状态

- 候选记忆单元

$$\tilde{C}_t=tanh(X_tW_{xc}+H_{t-1}W_{hc}+b_c)$$

- 记忆单元

$$C_t=F_t\bigodot C_{t-1}+I_t\bigodot \tilde{C}_t$$

LSTM 的状态有两个，一个为 C，一个为 H。

- 隐状态

$$H_t=O_t\bigodot $$

## 参考

- 《动手学深度学习》
